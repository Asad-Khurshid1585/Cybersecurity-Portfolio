# Add this new route to your Flask app

@app.route('/api/remediation/<vulnerability_id>', methods=['GET'])
@app.route('/api/remediation/<vulnerability_id>/<method>', methods=['GET'])
def get_remediation(vulnerability_id, method=None):
    """Get remediation suggestions for a vulnerability."""
    try:
        # Find the vulnerability in the database
        vulnerability = db.get_vulnerability_by_id(vulnerability_id)
        
        if not vulnerability:
            return jsonify({"error": "Vulnerability not found"}), 404
        
        # Determine which remediation method to use
        use_generative = (method == 'generative')
        
        # Get remediation suggestion
        remediation_generator = RemediationGenerator(use_generative=use_generative)
        remediation = remediation_generator.get_remediation_suggestion(
            vulnerability, 
            use_generative=use_generative
        )
        
        return jsonify({"remediation": remediation})
        
    except Exception as e:
        logger.error(f"Error getting remediation: {e}")
        return jsonify({"error": str(e)}), 500
